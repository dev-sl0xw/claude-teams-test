# 관리형 서비스와 지속 가능성

## 왜 이것이 중요한가? (질문)

> 읽기 전에 스스로에게 물어보세요: 직접 MySQL 서버를 운영하는 것과 Amazon RDS를 사용하는 것 중 어떤 것이 환경에 더 나을까요? 이유를 설명할 수 있나요?

## 핵심 개념

### 직접 운영 vs 관리형 서비스의 환경 영향

**질문: 1,000개의 회사가 각각 자체 데이터베이스 서버를 운영하는 것과, AWS RDS에서 공유 인프라로 운영하는 것 중 어느 쪽이 에너지를 더 적게 사용할까요?**

```
직접 운영 (Self-managed):
┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐
│회사 A │ │회사 B │ │회사 C │ │...   │ × 1,000
│ DB   │ │ DB   │ │ DB   │ │ DB   │
│사용률 │ │사용률 │ │사용률 │ │사용률 │
│ 15%  │ │ 8%   │ │ 22%  │ │ 5%   │
└──────┘ └──────┘ └──────┘ └──────┘
→ 각 서버가 유휴 전력 소비 중

관리형 서비스 (AWS Managed):
┌─────────────────────────────────────────────┐
│           AWS RDS 공유 인프라                  │
│  ┌──┐┌──┐┌──┐┌──┐┌──┐┌──┐┌──┐              │
│  │A ││B ││C ││D ││E ││F ││..│  효율적 배치  │
│  └──┘└──┘└──┘└──┘└──┘└──┘└──┘              │
│           사용률 70~80%                       │
└─────────────────────────────────────────────┘
→ 높은 사용률 = 높은 에너지 효율
```

### 규모의 경제와 에너지 효율

**질문: 왜 AWS 데이터센터가 개별 기업의 서버실보다 에너지 효율이 높을까요?**

1. **PUE (Power Usage Effectiveness)** 최적화
   - 일반 기업 서버실 PUE: 2.0~2.5 (IT 장비 1W당 냉각 등에 1~1.5W 추가 소비)
   - AWS 데이터센터 PUE: 약 1.2 (IT 장비 1W당 냉각 등에 0.2W만 추가)
   - 같은 연산을 수행해도 AWS에서 훨씬 적은 총 에너지를 사용합니다

2. **하드웨어 사용률 극대화**
   - 기업 자체 서버: 평균 사용률 10~20%
   - AWS: 멀티 테넌시로 사용률 60~80%

3. **최신 하드웨어 빠른 도입**
   - AWS는 최신 에너지 효율 하드웨어를 빠르게 도입합니다
   - 기업은 감가상각 주기(3~5년) 동안 구형 장비를 유지합니다

4. **커스텀 칩 설계**
   - Graviton: ARM 기반 커스텀 프로세서
   - Inferentia/Trainium: ML 전용 칩
   - Nitro System: 가상화 오버헤드 최소화

### 서버리스의 지속 가능성 기여

**질문: Lambda 함수가 하루에 1,000번 호출된다면, 나머지 시간에는 에너지를 소비할까요?**

서버리스가 지속 가능성에 기여하는 핵심 메커니즘:

```
전통적 서버:
시간 →  00  04  08  12  16  20  24
전력 →  ████████████████████████████  (24시간 소비)
요청 →  ░░░░████████████████░░░░░░░░  (업무 시간만 처리)
효율 →  낮음 ❌

서버리스:
시간 →  00  04  08  12  16  20  24
전력 →  ░░░░████████████████░░░░░░░░  (요청 시만 소비)
요청 →  ░░░░████████████████░░░░░░░░  (업무 시간만 처리)
효율 →  높음 ✓
```

**주요 서버리스 서비스와 지속 가능성 기여:**

| 서비스 | 대체 대상 | 지속 가능성 이점 |
|--------|----------|----------------|
| Lambda | EC2 (항상 실행) | 요청 시에만 컴퓨팅 자원 소비 |
| Fargate | EC2 기반 ECS/EKS | 컨테이너 단위 자원 할당, 유휴 제거 |
| DynamoDB (온디맨드) | RDS (항상 실행) | 요청량에 비례한 자원 소비 |
| S3 | 자체 스토리지 서버 | 수명주기 정책으로 불필요 데이터 자동 정리 |
| API Gateway | 자체 API 서버 | 요청 시에만 처리 |

**질문: 모든 워크로드를 서버리스로 전환하면 가장 친환경적일까요? 그렇지 않다면 왜일까요?**

힌트: 항상 높은 트래픽이 유지되는 워크로드에서는 서버리스의 오버헤드(콜드 스타트, 함수 초기화)가 오히려 에너지를 더 소비할 수 있습니다.

### Graviton 프로세서의 에너지 효율

**질문: 같은 성능을 내면서 40% 적은 에너지를 사용하는 프로세서가 있다면, 왜 모든 기업이 이것을 사용하지 않을까요?**

#### Graviton이란?

AWS가 자체 설계한 ARM 기반 프로세서입니다:

- **Graviton2**: x86 대비 최대 40% 에너지 효율 향상
- **Graviton3**: Graviton2 대비 최대 25% 추가 성능, 60% 적은 에너지
- **Graviton4**: 가장 최신, 더 높은 성능과 효율

#### 왜 ARM이 에너지 효율적인가?

```
x86 (CISC 아키텍처):
- 복잡한 명령어 세트 → 회로가 복잡 → 전력 소비 높음
- 레거시 호환성 유지 → 불필요한 회로도 전력 소비

ARM (RISC 아키텍처):
- 단순한 명령어 세트 → 회로가 단순 → 전력 소비 낮음
- 필요한 기능만 포함 → 에너지 낭비 최소화
- 모바일에서 검증된 저전력 설계
```

#### Graviton 인스턴스 패밀리

| 패밀리 | 용도 | Graviton 버전 |
|--------|------|--------------|
| t4g | 범용 (버스트) | Graviton2 |
| m7g | 범용 (안정) | Graviton3 |
| c7g | 컴퓨팅 최적화 | Graviton3 |
| r7g | 메모리 최적화 | Graviton3 |
| m8g | 범용 (최신) | Graviton4 |

**질문: t4g.micro는 프리 티어에 포함됩니다. 이것은 AWS가 Graviton 채택을 장려하기 위한 전략일까요?**

#### Graviton 전환 시 고려사항

- 대부분의 Linux 기반 워크로드는 바로 사용 가능
- x86 전용 바이너리/라이브러리 확인 필요
- Docker 이미지는 multi-arch 빌드 권장
- Windows 워크로드는 현재 지원하지 않음

## 잠깐, 그런데... (흔한 오해)

### 오해 1: "관리형 서비스는 비싸니까 직접 운영이 환경에 더 나을 수 있다"
관리형 서비스의 비용에는 AWS의 에너지 효율 인프라 비용이 포함되어 있습니다. 직접 운영 시 보이지 않는 에너지 비용(냉각, 유휴 전력 등)을 계산하면 관리형 서비스가 거의 항상 더 효율적입니다.

### 오해 2: "서버리스는 항상 더 친환경적이다"
높은 트래픽이 지속되는 워크로드에서는 항상 실행되는 서버가 더 효율적일 수 있습니다. Lambda의 콜드 스타트와 매 호출마다의 초기화 오버헤드를 고려해야 합니다. **적합한 워크로드에 적합한 기술**을 선택하는 것이 핵심입니다.

### 오해 3: "Graviton은 성능이 x86보다 낮다"
Graviton3는 많은 벤치마크에서 x86과 동등하거나 더 높은 성능을 보여줍니다. 특히 가격 대비 성능(price-performance)에서는 확실히 우수합니다. 단, x86 전용 소프트웨어 호환성은 확인이 필요합니다.

## 핸즈온 연결

- **Lab 01**: t4g, m7g, c7g Graviton 인스턴스를 CDK로 배포
- **Lab 02**: Lambda + API Gateway + DynamoDB 서버리스 아키텍처 구축

## SAA 시험 핵심 포인트

1. **관리형 서비스**는 공유 인프라의 높은 사용률로 에너지 효율이 우수합니다
2. **Graviton**은 AWS 자체 설계 ARM 프로세서로, x86 대비 최대 40% 에너지 절약
3. **서버리스**는 유휴 리소스를 제거하여 지속 가능성에 기여합니다
4. **DynamoDB 온디맨드 모드**는 사용한 만큼만 용량을 할당합니다
5. **Fargate**는 EC2 기반 컨테이너 실행보다 리소스를 효율적으로 사용합니다
6. **PUE**는 데이터센터 에너지 효율을 측정하는 지표입니다 (1.0에 가까울수록 효율적)
7. 워크로드 특성에 따라 서버리스 vs 서버 기반을 선택해야 합니다

## 관련 Pillar

- **비용 최적화 (Cost Optimization)**: 관리형 서비스와 서버리스로 운영 비용 절감
- **성능 효율성 (Performance Efficiency)**: Graviton의 높은 가격 대비 성능
- **운영 우수성 (Operational Excellence)**: 관리형 서비스로 운영 부담 감소
- **신뢰성 (Reliability)**: AWS 관리형 서비스의 내장된 고가용성
